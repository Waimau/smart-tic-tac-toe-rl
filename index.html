
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>Reinforcement Learning Tic Tac Toe with Value Function - Hong Jing (Jingles)</title>
  <link rel="icon" type="image/png" href="https://jinglescode.github.io/assets/img/favicon.png">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel='stylesheet' type='text/css'>
  <link href="https://jinglescode.github.io/assets/css/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="https://jinglescode.github.io/assets/css/custom.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link rel="preload" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" as="style" onload="this.rel='stylesheet'">
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-49548145-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-49548145-2');
  </script>
  <meta property="og:title" content="Reinforcement Learning Tic Tac Toe with Value Function - Hong Jing (Jingles)"/>
  <meta property="og:image" content="https://jinglescode.github.io/assets/img/posts/rl-value-func-00.jpg"/>
  <meta property="og:description" content="A simple reinforcement learning algorithm for agents to learn the game tic-tac-toe. This demonstrate the purpose of the value function."/>
  <meta property="og:url" content="https://jinglescode.github.io/time-series-forecasting-tensorflowjs" />
</head>
<body>

  <div class="navbar-fixed">
    <nav class="z-depth-2 nav-bar" role="navigation">
      <div class="nav-wrapper container">
        <a id="logo-container" class="brand-logo truncate">
          Reinforcement Learning Tic Tac Toe with Value Function
        </a>
        <ul class="right hide-on-med-and-down">
          <li><a href="https://jinglescode.github.io/" class="tooltipped" data-position="top" data-tooltip="Blog"><i class="fas fa-blog"></i><span id="menu-text">Blog</span></a></li>
          <li><a href="https://jinglescode.github.io/playground/" class="tooltipped" data-position="top" data-tooltip="Playground"><i class="fas fa-laptop-code"></i><span id="menu-text">Playground</span></a></li>
          <li><a href="https://github.com/jinglescode" target="_blank"><i class="fab fa-github-square"></i><span id="menu-text">GitHub</span></a></li>
        </ul>
        <a href="#" data-target="slide-out" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      </div>
    </nav>
    <a href="#" data-target="slide-out" class="sidenav-trigger"><i class="material-icons">menu</i></a>
  </div>
  <ul id="slide-out" class="sidenav">
    <li><a href="https://jinglescode.github.io/" class="tooltipped" data-position="top" data-tooltip="Blog"><i class="fas fa-blog"></i><span id="menu-text">Blog</span></a></li>
    <li><a href="https://jinglescode.github.io/playground/" class="tooltipped" data-position="top" data-tooltip="Playground"><i class="fas fa-laptop-code"></i><span id="menu-text">Playground</span></a></li>
    <li><a href="https://github.com/jinglescode" target="_blank"><i class="fab fa-github-square"></i><span id="menu-text">GitHub</span></a></li>
  </ul>

  <div class="container blog-content">

    <div class="card">
      <div class="card-content">
        <h1 class="title grey-text text-darken-4">Reinforcement Learning Tic Tac Toe with Value Function</h1>
        <h5 class="subtitle grey-text text-darken-2">A simple reinforcement learning algorithm for agents to learn the game tic-tac-toe. This demonstrate the purpose of the value function.</h5>
      </div>
      <div class="card-image">
        <img src="https://jinglescode.github.io/assets/img/posts/rl-value-func-00.jpg" alt="Reinforcement Learning Tic Tac Toe with Value Function">
      </div>
      <div class="card-content">
        <p>
          A simple reinforcement learning algorithm for agents to learn the game tic-tac-toe. This project demonstrate the purpose of the value function.
        </p>
        <p>
          You begin by training the agent, where 2 agents (agent X and agent O) will be created and trained through simulation. These 2 agents will be playing a number of games determined by 'number of episodes'. You can adjust the 1) learning rate and 2) the probability of exploration of each agent. After training, you can play against agent X.
        </p>
        <p>
          The 9 percentages on the right show the value of each grid at each state. Don't give up when playing against the trained agent! Because as humans, we can actually outsmart them. Try it! The agents are still learning as you play. You will notice the percentages of those grids that used to be very confident dropping over time if the agent didn't manage to win for a few games.
        </p>
      </div>
    </div>

    <div class="card">
      <div class="card-content">
        <h1>Demo</h1>
        <div class="row">
          <div class="col s12 m5">
            <span class="card-title">Train Agent</span>

            <div class="row">
              <div class="input-field col s12">
                <label for="input_episodes">Number of Episodes</label>
                <input type="text" id="input_episodes" placeholder="example: 10000" value="10000">
                <small class="form-text text-muted">Number of times agent play against each other in simulation</small>
              </div>
              <div class="input-field col s12">
                <label for="input_agent1_explore_probability">Agent 1 Explore Probability</label>
                <input type="text" id="input_agent1_explore_probability" placeholder="example: 0.05" value="0.05">
              </div>
              <div class="input-field col s12">
                <label for="input_agent1_learning_rate">Agent 1 Learning Rate</label>
                <input type="text" id="input_agent1_learning_rate" placeholder="example: 0.5" value="0.5">
              </div>
              <div class="input-field col s12">
                <label for="input_agent2_explore_probability">Agent 2 Explore Probability</label>
                <input type="text" id="input_agent2_explore_probability" placeholder="example: 0.05" value="0.05">
              </div>
              <div class="input-field col s12">
                <label for="input_agent2_learning_rate">Agent 2 Learning Rate</label>
                <input type="text" id="input_agent2_learning_rate" placeholder="example: 0.5" value="0.5">
              </div>
              <div class="col s6">
                <button class="waves-effect waves-light btn" id="btn_train_agents" onclick="train_agents()">Train Agents</button>
              </div>
              <div class="col s6">
                <button class="waves-effect waves-light btn" id="btn_agent_simulation" onclick="agent_simulation()">Simulation</button>
              </div>
            </div>

          </div> <!-- E <div class="col s12 m5"> -->

          <div class="col s12 m7">
            <span class="card-title">Play against agent (Skill level: <span id="agent_skill_level"></span>)</span>
            <blockquote>
              <span id="message"></span>
            </blockquote>

            <div class="row">
              <div class="col s12">
                <table>
                  <tr>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click0" onclick="human_player_move(0)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click1" onclick="human_player_move(1)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click2" onclick="human_player_move(2)">.</button></td>
                  </tr>
                  <tr>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click3" onclick="human_player_move(3)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click4" onclick="human_player_move(4)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click5" onclick="human_player_move(5)">.</button></td>
                  </tr>
                  <tr>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click6" onclick="human_player_move(6)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click7" onclick="human_player_move(7)">.</button></td>
                    <td><button class="waves-effect waves-light btn white" id="btn_ttt_click8" onclick="human_player_move(8)">.</button></td>
                  </tr>
                </table>
              </div>
              <div class="col s12">
                <span class="card-title">Agent's Value Function</span>
                <table>
                  <tr>
                    <td><span id="btn_ttt_prob0">.</span></td>
                    <td><span id="btn_ttt_prob1">.</span></td>
                    <td><span id="btn_ttt_prob2">.</span></td>
                  </tr>
                  <tr>
                    <td><span id="btn_ttt_prob3">.</span></td>
                    <td><span id="btn_ttt_prob4">.</span></td>
                    <td><span id="btn_ttt_prob5">.</span></td>
                  </tr>
                  <tr>
                    <td><span id="btn_ttt_prob6">.</span></td>
                    <td><span id="btn_ttt_prob7">.</span></td>
                    <td><span id="btn_ttt_prob8">.</span></td>
                  </tr>
                </table>
              </div>
              <div class="col s12">
                <button class="waves-effect waves-light btn" id="btn_reset_game" onclick="reset_game()">Reset Game</button>
              </div>

            </div>

          </div> <!-- E <div class="col s12 m7"> -->

        </div>
      </div>
    </div>
    <!-- E train agent -->

    <div class="card">
      <div class="card-content">
        <h1>Evaluate Epsilon Greedy</h1>

        <p>
          In order to figure out the most suitable epsilon-greedy value, I will test different epsilon-greedy value. First, initialise agent X with epsilon-greedy of 0.01, means there is 1% probability agent X will choose to explore instead of exploiting. Then, agents will play against each other for 10,000 games, and I will record the number of times agent X wins. After 10,000 games, I will increase the epsilon-greedy value to 0.02 and agents will play another 10,000 games.
        </p>
        <h2>
          Agent X (eps increment) vs Agent O (eps 0.05)
        </h2>
        <p>The blue line is the number of times agent X won against agent O. The winning rate decreases as the epsilon-greedy value increases and peaked at winning 9268 games at the epsilon-greedy value of 0.05 (agent X explores 5% of the time). Agent O begin to win more games as agent X explores more than 50% of the time.</p>
        <div class="card z-depth-2">
          <div class="card-content">
            <span class="card-title">Agent X (eps increment) vs Agent O (eps 0.05)</span>
            <div>
              <div id="demo_agentx_graph_1" style="width:100%; height:350px;"></div>
            </div>
          </div>
        </div>

        <h2>
          Agent O (eps increment) vs Agent X (eps 0.05)
        </h2>
        <p>Let us try something, by experimenting with different epsilon greedy for agent O, challenging agent X with an optimal 5% epsilon greedy.</p>
        <p>Given agent X has optimal epsilon greedy and advantage to start first in the game, agent O lost the game before it is able to learn the game.</p>
        <div class="card z-depth-2">
          <div class="card-content">
            <span class="card-title">Agent X (eps increment) vs Agent O (eps 0.05)</span>
            <div>
              <div id="demo_agento_graph_1" style="width:100%; height:350px;"></div>
            </div>
          </div>
        </div>

        <h2>
          Agent O (eps increment) vs Agent X (eps 1)
        </h2>
        <p>Let's tweak epsilon greedy of agent X to 100%, where agent X will be playing random actions all the time.</p>
        <p>Agent O is able to learn the game and win against agent X, peaking at 4% epsilon greedy and begin losing at 30%.</p>